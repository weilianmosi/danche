{"ast":null,"code":"import \"antd/lib/transfer/style\";\nimport _Transfer from \"antd/lib/transfer\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _objectSpread from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\\\u5355\\u8F66\\u540E\\u53F0\\u7BA1\\u7406\\u7CFB\\u7EDF\\u5F00\\u53D1\\\\imoocmanager\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/tree/style\";\nimport _Tree from \"antd/lib/tree\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nvar _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\\\u5355\\u8F66\\u540E\\u53F0\\u7BA1\\u7406\\u7CFB\\u7EDF\\u5F00\\u53D1\\\\imoocmanager\\\\src\\\\pages\\\\permission\\\\index.js\";\nimport React from 'react';\nimport ETable from './../../components/ETable';\nimport Utils from './../../utils/utils.js';\nimport axios from './../../axios/index.js';\nimport menuConfig from './../../config/menuConfig.js';\nconst Option = _Select.Option;\nconst FormItem = _Form.Item;\nconst TreeNode = _Tree.TreeNode;\nexport default class PermissionUser extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      isRoleVisible: false,\n      isUserVisible: false\n    };\n\n    this.handleRole = () => {\n      this.setState({\n        isRoleVisible: true\n      });\n    };\n\n    this.handleRoleSubmit = () => {\n      let data = this.roleForm.props.form.getFieldsValue();\n      axios.ajax({\n        url: '/role/create',\n        data: {\n          params: data\n        }\n      }).then(res => {\n        if (res.code == 0) {\n          this.setState({\n            isRoleVisible: false\n          });\n          this.roleForm.props.form.resetFields();\n          axios.requestList(this, '/role/list', {});\n        }\n      });\n    };\n\n    this.handlePermission = () => {\n      let item = this.state.selectedItem;\n\n      if (!item) {\n        _Modal.info({\n          title: '请选择一个角色'\n        });\n\n        return;\n      }\n\n      this.setState({\n        isPermVisible: true,\n        detailInfo: item,\n        menuInfo: item.menus\n      });\n    };\n\n    this.handlePermEditSubmit = () => {\n      let data = this.permForm.props.form.getFieldsValue();\n      data.role_id = this.state.selectedItem.id;\n      data.menus = this.state.menuInfo;\n      axios.ajax({\n        url: '/permission/edit',\n        data: {\n          params: _objectSpread({}, data)\n        }\n      }).then(res => {\n        if (res) {\n          this.setState({\n            isPermVisible: false\n          });\n          axios.requestList(this, '/role/list', {});\n        }\n      });\n    };\n\n    this.handleUserAuth = () => {\n      let item = this.state.selectedItem;\n\n      if (!item) {\n        _Modal.info({\n          title: '请选择一个角色'\n        });\n\n        return;\n      }\n\n      this.setState({\n        isUserVisible: true,\n        detailInfo: item\n      });\n      this.getRoleUserList(item.id);\n    };\n\n    this.getRoleUserList = id => {\n      axios.ajax({\n        url: '/role/user_list',\n        data: {\n          params: {\n            id\n          }\n        }\n      }).then(res => {\n        if (res) {\n          this.getAuthUserList(res.result);\n        }\n      });\n    };\n\n    this.getAuthUserList = dataSource => {\n      const mockData = [];\n      const targetKeys = [];\n\n      if (dataSource && dataSource.length > 0) {\n        for (let i = 0; i < dataSource.length; i++) {\n          const data = {\n            key: dataSource[i].user_id,\n            title: dataSource[i].user_name,\n            status: dataSource[i].status\n          };\n\n          if (data.status == 1) {\n            targetKeys.push(data.key);\n          }\n\n          mockData.push(data);\n        }\n\n        this.setState({\n          mockData,\n          targetKeys\n        });\n      }\n    };\n\n    this.handleUserSubmit = () => {\n      let data = {};\n      data.user_ids = this.state.targetKeys;\n      data.role_id = this.state.selectedItem.id;\n      axios.ajax({\n        url: '/role/user_role_edit',\n        data: {\n          params: _objectSpread({}, data)\n        }\n      }).then(res => {\n        if (res) {\n          this.setState({\n            isUserVisible: false\n          });\n          axios.requestList(this, '/role/list', {});\n        }\n      });\n    };\n  }\n\n  componentDidMount() {\n    axios.requestList(this, '/role/list', {});\n  } // 打开创建角色弹框\n\n\n  render() {\n    const columns = [{\n      title: '角色ID',\n      dataIndex: 'id'\n    }, {\n      title: '角色名称',\n      dataIndex: 'role_name'\n    }, {\n      title: '创建时间',\n      dataIndex: 'create_time',\n      render: Utils.formateDate\n    }, {\n      title: '使用状态',\n      dataIndex: 'status',\n\n      render(status) {\n        return status == 1 ? '启用' : '停用';\n      }\n\n    }, {\n      title: '授权时间',\n      dataIndex: 'authorize_time',\n      render: Utils.formateDate\n    }, {\n      title: '授权人',\n      dataIndex: 'authorize_user_name'\n    }];\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(_Card, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(_Button, {\n      type: \"primary\",\n      onClick: this.handleRole,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, \"\\u521B\\u5EFA\\u89D2\\u8272\"), React.createElement(_Button, {\n      type: \"primary\",\n      style: {\n        marginLeft: 15,\n        marginRight: 15\n      },\n      onClick: this.handlePermission,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"\\u8BBE\\u7F6E\\u6743\\u9650\"), React.createElement(_Button, {\n      type: \"primary\",\n      onClick: this.handleUserAuth,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"\\u7528\\u6237\\u6388\\u6743\")), React.createElement(\"div\", {\n      className: \"content-wrap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, React.createElement(ETable, {\n      updateSelectedItem: Utils.updateSelectedItem.bind(this),\n      selectedRowKeys: this.state.selectedRowKeys,\n      dataSource: this.state.list,\n      columns: columns,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    })), React.createElement(_Modal, {\n      title: \"\\u521B\\u5EFA\\u89D2\\u8272\",\n      visible: this.state.isRoleVisible,\n      onOk: this.handleRoleSubmit,\n      onCancel: () => {\n        this.roleForm.props.form.resetFields();\n        this.setState({\n          isRoleVisible: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(RoleForm, {\n      wrappedComponentRef: inst => this.roleForm = inst,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    })), React.createElement(_Modal, {\n      title: \"\\u8BBE\\u7F6E\\u6743\\u9650\",\n      visible: this.state.isPermVisible,\n      width: 600,\n      onOk: this.handlePermEditSubmit,\n      onCancel: () => {\n        this.setState({\n          isPermVisible: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, React.createElement(PermEditForm, {\n      wrappedComponentRef: inst => this.permForm = inst,\n      detailInfo: this.state.detailInfo,\n      menuInfo: this.state.menuInfo,\n      patchMenuInfo: checkedKeys => {\n        this.setState({\n          menuInfo: checkedKeys\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    })), React.createElement(_Modal, {\n      title: \"\\u7528\\u6237\\u6388\\u6743\",\n      visible: this.state.isUserVisible,\n      width: 800,\n      onOk: this.handleUserSubmit,\n      onCancel: () => {\n        this.setState({\n          isUserVisible: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }, React.createElement(RoleAuthForm, {\n      wrappedComponentRef: inst => this.userAuthForm = inst,\n      detailInfo: this.state.detailInfo,\n      targetKeys: this.state.targetKeys,\n      mockData: this.state.mockData,\n      patchUserInfo: targetKeys => {\n        this.setState({\n          targetKeys\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    })));\n  }\n\n}\n\nclass RoleForm extends React.Component {\n  render() {\n    let type = this.props.type;\n    const getFieldDecorator = this.props.form.getFieldDecorator;\n    const formTtemLayout = {\n      labelCol: {\n        span: 5\n      },\n      wrapperCol: {\n        span: 15\n      }\n    };\n    return React.createElement(_Form, {\n      layout: \"horizontal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, React.createElement(FormItem, Object.assign({\n      label: \"\\u89D2\\u8272\\u540D\\u79F0\"\n    }, formTtemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }), getFieldDecorator('role_name')(React.createElement(_Input, {\n      type: \"text\",\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u89D2\\u8272\\u540D\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }))), React.createElement(FormItem, Object.assign({\n      label: \"\\u72B6\\u6001\"\n    }, formTtemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }), getFieldDecorator('state')(React.createElement(_Select, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }, React.createElement(Option, {\n      value: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, \"\\u5F00\\u542F\"), React.createElement(Option, {\n      value: 2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }, \"\\u5173\\u95ED\")))));\n  }\n\n}\n\nRoleForm = _Form.create({})(RoleForm);\n\nclass PermEditForm extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.onCheck = checkedKeys => {\n      this.props.patchMenuInfo(checkedKeys);\n    };\n\n    this.renderTreeNodes = data => {\n      return data.map(item => {\n        if (item.children) {\n          return React.createElement(TreeNode, {\n            title: item.title,\n            key: item.key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 304\n            },\n            __self: this\n          }, this.renderTreeNodes(item.children));\n        } else return React.createElement(TreeNode, {\n          title: item.title,\n          key: item.key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 307\n          },\n          __self: this\n        });\n      });\n    };\n  }\n\n  render() {\n    const getFieldDecorator = this.props.form.getFieldDecorator;\n    const formTtemLayout = {\n      labelCol: {\n        span: 5\n      },\n      wrapperCol: {\n        span: 15\n      }\n    };\n    const detail_info = this.props.detailInfo;\n    const menuInfo = this.props.menuInfo;\n    return React.createElement(_Form, {\n      layout: \"horizontal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, React.createElement(FormItem, Object.assign({\n      label: \"\\u89D2\\u8272\\u540D\\u79F0\"\n    }, formTtemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320\n      },\n      __self: this\n    }), React.createElement(_Input, {\n      disabled: true,\n      placeholder: detail_info.role_name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    })), React.createElement(FormItem, Object.assign({\n      label: \"\\u72B6\\u6001\"\n    }, formTtemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }), getFieldDecorator('status', {\n      initialValue: '1'\n    })(React.createElement(_Select, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328\n      },\n      __self: this\n    }, React.createElement(Option, {\n      value: \"1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329\n      },\n      __self: this\n    }, \"\\u542F\\u7528\"), React.createElement(Option, {\n      value: \"0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330\n      },\n      __self: this\n    }, \"\\u505C\\u7528\")))), React.createElement(_Tree, {\n      checkable: true,\n      defaultExpandAll: true,\n      onCheck: checkedKeys => {\n        this.onCheck(checkedKeys);\n      },\n      checkedKeys: menuInfo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    }, React.createElement(TreeNode, {\n      title: \"\\u5E73\\u53F0\\u6743\\u9650\",\n      key: \"platform_all\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343\n      },\n      __self: this\n    }, this.renderTreeNodes(menuConfig))));\n  }\n\n}\n\nPermEditForm = _Form.create({})(PermEditForm);\n\nclass RoleAuthForm extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.filterOption = (inputValue, option) => option.title.indexOf(inputValue) > -1;\n\n    this.handleChange = targetKeys => {\n      this.props.patchUserInfo(targetKeys);\n    };\n  }\n\n  render() {\n    const getFieldDecorator = this.props.form.getFieldDecorator;\n    const formTtemLayout = {\n      labelCol: {\n        span: 5\n      },\n      wrapperCol: {\n        span: 15\n      }\n    };\n    const detail_info = this.props.detailInfo;\n    const menuInfo = this.props.menuInfo;\n    return React.createElement(_Form, {\n      layout: \"horizontal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369\n      },\n      __self: this\n    }, React.createElement(FormItem, Object.assign({\n      label: \"\\u89D2\\u8272\\u540D\\u79F0\"\n    }, formTtemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 370\n      },\n      __self: this\n    }), React.createElement(_Input, {\n      disabled: true,\n      placeholder: detail_info.role_name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371\n      },\n      __self: this\n    })), React.createElement(FormItem, Object.assign({\n      label: \"\\u9009\\u62E9\\u7528\\u6237\"\n    }, formTtemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 373\n      },\n      __self: this\n    }), React.createElement(_Transfer, {\n      listStyle: {\n        width: 200,\n        height: 400\n      },\n      dataSource: this.props.mockData,\n      titles: ['待选用户', '已选用户'],\n      showSearch: true,\n      searchPlaceholder: \"\\u8F93\\u5165\\u7528\\u6237\\u540D\",\n      filterOption: this.filterOption,\n      targetKeys: this.props.targetKeys,\n      onChange: this.handleChange,\n      render: item => item.title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374\n      },\n      __self: this\n    })));\n  }\n\n}\n\nRoleAuthForm = _Form.create({})(RoleAuthForm);","map":{"version":3,"sources":["C:\\Users\\Administrator\\Desktop\\单车后台管理系统开发\\imoocmanager\\src\\pages\\permission\\index.js"],"names":["React","ETable","Utils","axios","menuConfig","Option","FormItem","Item","TreeNode","PermissionUser","Component","state","isRoleVisible","isUserVisible","handleRole","setState","handleRoleSubmit","data","roleForm","props","form","getFieldsValue","ajax","url","params","then","res","code","resetFields","requestList","handlePermission","item","selectedItem","info","title","isPermVisible","detailInfo","menuInfo","menus","handlePermEditSubmit","permForm","role_id","id","handleUserAuth","getRoleUserList","getAuthUserList","result","dataSource","mockData","targetKeys","length","i","key","user_id","user_name","status","push","handleUserSubmit","user_ids","componentDidMount","render","columns","dataIndex","formateDate","marginLeft","marginRight","updateSelectedItem","bind","selectedRowKeys","list","inst","checkedKeys","userAuthForm","RoleForm","type","getFieldDecorator","formTtemLayout","labelCol","span","wrapperCol","create","PermEditForm","onCheck","patchMenuInfo","renderTreeNodes","map","children","detail_info","role_name","initialValue","RoleAuthForm","filterOption","inputValue","option","indexOf","handleChange","patchUserInfo","width","height"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAOC,MAAP,MAAmB,2BAAnB;AACA,OAAOC,KAAP,MAAkB,wBAAlB;AACA,OAAOC,KAAP,MAAkB,wBAAlB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AAEA,MAAMC,MAAM,GAAG,QAAOA,MAAtB;AACA,MAAMC,QAAQ,GAAG,MAAKC,IAAtB;MACQC,Q,SAAAA,Q;AACR,eAAe,MAAMC,cAAN,SAA6BT,KAAK,CAACU,SAAnC,CAA4C;AAAA;AAAA;AAAA,SACzDC,KADyD,GACjD;AACNC,MAAAA,aAAa,EAAE,KADT;AAENC,MAAAA,aAAa,EAAE;AAFT,KADiD;;AAAA,SASzDC,UATyD,GAS5C,MAAM;AACjB,WAAKC,QAAL,CAAc;AACZH,QAAAA,aAAa,EAAE;AADH,OAAd;AAGD,KAbwD;;AAAA,SAezDI,gBAfyD,GAetC,MAAM;AACvB,UAAIC,IAAI,GAAG,KAAKC,QAAL,CAAcC,KAAd,CAAoBC,IAApB,CAAyBC,cAAzB,EAAX;AACAlB,MAAAA,KAAK,CAACmB,IAAN,CAAW;AACTC,QAAAA,GAAG,EAAE,cADI;AAETN,QAAAA,IAAI,EAAE;AACJO,UAAAA,MAAM,EAAEP;AADJ;AAFG,OAAX,EAKGQ,IALH,CAKSC,GAAD,IAAS;AACf,YAAGA,GAAG,CAACC,IAAJ,IAAY,CAAf,EAAkB;AAChB,eAAKZ,QAAL,CAAc;AACZH,YAAAA,aAAa,EAAE;AADH,WAAd;AAGA,eAAKM,QAAL,CAAcC,KAAd,CAAoBC,IAApB,CAAyBQ,WAAzB;AACAzB,UAAAA,KAAK,CAAC0B,WAAN,CAAkB,IAAlB,EAAuB,YAAvB,EAAoC,EAApC;AACD;AACF,OAbD;AAcD,KA/BwD;;AAAA,SAiCzDC,gBAjCyD,GAiCtC,MAAM;AACvB,UAAIC,IAAI,GAAG,KAAKpB,KAAL,CAAWqB,YAAtB;;AACA,UAAG,CAACD,IAAJ,EAAU;AACR,eAAME,IAAN,CAAW;AACTC,UAAAA,KAAK,EAAE;AADE,SAAX;;AAGA;AACD;;AACD,WAAKnB,QAAL,CAAc;AACZoB,QAAAA,aAAa,EAAE,IADH;AAEZC,QAAAA,UAAU,EAAEL,IAFA;AAGZM,QAAAA,QAAQ,EAAEN,IAAI,CAACO;AAHH,OAAd;AAKD,KA9CwD;;AAAA,SA+CzDC,oBA/CyD,GA+ClC,MAAM;AAC3B,UAAItB,IAAI,GAAG,KAAKuB,QAAL,CAAcrB,KAAd,CAAoBC,IAApB,CAAyBC,cAAzB,EAAX;AACAJ,MAAAA,IAAI,CAACwB,OAAL,GAAe,KAAK9B,KAAL,CAAWqB,YAAX,CAAwBU,EAAvC;AACAzB,MAAAA,IAAI,CAACqB,KAAL,GAAa,KAAK3B,KAAL,CAAW0B,QAAxB;AACAlC,MAAAA,KAAK,CAACmB,IAAN,CAAW;AACTC,QAAAA,GAAG,EAAE,kBADI;AAETN,QAAAA,IAAI,EAAG;AACLO,UAAAA,MAAM,oBACDP,IADC;AADD;AAFE,OAAX,EAOGQ,IAPH,CAOSC,GAAD,IAAS;AACf,YAAGA,GAAH,EAAQ;AACN,eAAKX,QAAL,CAAc;AACZoB,YAAAA,aAAa,EAAE;AADH,WAAd;AAGAhC,UAAAA,KAAK,CAAC0B,WAAN,CAAkB,IAAlB,EAAuB,YAAvB,EAAoC,EAApC;AACD;AACF,OAdD;AAeD,KAlEwD;;AAAA,SAoEzDc,cApEyD,GAoExC,MAAM;AACrB,UAAIZ,IAAI,GAAG,KAAKpB,KAAL,CAAWqB,YAAtB;;AACA,UAAG,CAACD,IAAJ,EAAU;AACR,eAAME,IAAN,CAAW;AACTC,UAAAA,KAAK,EAAE;AADE,SAAX;;AAGA;AACD;;AACD,WAAKnB,QAAL,CAAc;AACZF,QAAAA,aAAa,EAAE,IADH;AAEZuB,QAAAA,UAAU,EAAEL;AAFA,OAAd;AAIA,WAAKa,eAAL,CAAqBb,IAAI,CAACW,EAA1B;AACD,KAjFwD;;AAAA,SAmFzDE,eAnFyD,GAmFtCF,EAAD,IAAQ;AACxBvC,MAAAA,KAAK,CAACmB,IAAN,CAAW;AACTC,QAAAA,GAAG,EAAE,iBADI;AAETN,QAAAA,IAAI,EAAE;AACJO,UAAAA,MAAM,EAAE;AACNkB,YAAAA;AADM;AADJ;AAFG,OAAX,EAOGjB,IAPH,CAOSC,GAAD,IAAS;AACf,YAAGA,GAAH,EAAQ;AAEN,eAAKmB,eAAL,CAAqBnB,GAAG,CAACoB,MAAzB;AACD;AACF,OAZD;AAaD,KAjGwD;;AAAA,SAmGzDD,eAnGyD,GAmGtCE,UAAD,IAAgB;AAChC,YAAMC,QAAQ,GAAG,EAAjB;AACA,YAAMC,UAAU,GAAG,EAAnB;;AACA,UAAGF,UAAU,IAAIA,UAAU,CAACG,MAAX,GAAoB,CAArC,EAAwC;AACtC,aAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGJ,UAAU,CAACG,MAA9B,EAAsCC,CAAC,EAAvC,EAA2C;AACzC,gBAAMlC,IAAI,GAAG;AACXmC,YAAAA,GAAG,EAAEL,UAAU,CAACI,CAAD,CAAV,CAAcE,OADR;AAEXnB,YAAAA,KAAK,EAAEa,UAAU,CAACI,CAAD,CAAV,CAAcG,SAFV;AAGXC,YAAAA,MAAM,EAAER,UAAU,CAACI,CAAD,CAAV,CAAcI;AAHX,WAAb;;AAKA,cAAGtC,IAAI,CAACsC,MAAL,IAAe,CAAlB,EAAqB;AACnBN,YAAAA,UAAU,CAACO,IAAX,CAAgBvC,IAAI,CAACmC,GAArB;AACD;;AACDJ,UAAAA,QAAQ,CAACQ,IAAT,CAAcvC,IAAd;AAED;;AACD,aAAKF,QAAL,CAAc;AACZiC,UAAAA,QADY;AAEZC,UAAAA;AAFY,SAAd;AAID;AACF,KAxHwD;;AAAA,SA0HzDQ,gBA1HyD,GA0HtC,MAAM;AACvB,UAAIxC,IAAI,GAAG,EAAX;AACAA,MAAAA,IAAI,CAACyC,QAAL,GAAgB,KAAK/C,KAAL,CAAWsC,UAA3B;AACAhC,MAAAA,IAAI,CAACwB,OAAL,GAAe,KAAK9B,KAAL,CAAWqB,YAAX,CAAwBU,EAAvC;AACAvC,MAAAA,KAAK,CAACmB,IAAN,CAAW;AACTC,QAAAA,GAAG,EAAE,sBADI;AAETN,QAAAA,IAAI,EAAE;AACJO,UAAAA,MAAM,oBACDP,IADC;AADF;AAFG,OAAX,EAOGQ,IAPH,CAOSC,GAAD,IAAS;AACf,YAAGA,GAAH,EAAQ;AACN,eAAKX,QAAL,CAAc;AACZF,YAAAA,aAAa,EAAE;AADH,WAAd;AAGAV,UAAAA,KAAK,CAAC0B,WAAN,CAAkB,IAAlB,EAAuB,YAAvB,EAAoC,EAApC;AACD;AACF,OAdD;AAeD,KA7IwD;AAAA;;AAKzD8B,EAAAA,iBAAiB,GAAG;AAClBxD,IAAAA,KAAK,CAAC0B,WAAN,CAAkB,IAAlB,EAAuB,YAAvB,EAAoC,EAApC;AACD,GAPwD,CAQzD;;;AAsIA+B,EAAAA,MAAM,GAAG;AACP,UAAMC,OAAO,GAAG,CACd;AACE3B,MAAAA,KAAK,EAAE,MADT;AAEE4B,MAAAA,SAAS,EAAE;AAFb,KADc,EAKd;AACE5B,MAAAA,KAAK,EAAE,MADT;AAEE4B,MAAAA,SAAS,EAAE;AAFb,KALc,EASd;AACE5B,MAAAA,KAAK,EAAE,MADT;AAEE4B,MAAAA,SAAS,EAAE,aAFb;AAGEF,MAAAA,MAAM,EAAE1D,KAAK,CAAC6D;AAHhB,KATc,EAcd;AACE7B,MAAAA,KAAK,EAAE,MADT;AAEE4B,MAAAA,SAAS,EAAE,QAFb;;AAGEF,MAAAA,MAAM,CAACL,MAAD,EAAQ;AACZ,eAAOA,MAAM,IAAI,CAAV,GAAc,IAAd,GAAqB,IAA5B;AACD;;AALH,KAdc,EAqBd;AACErB,MAAAA,KAAK,EAAE,MADT;AAEE4B,MAAAA,SAAS,EAAE,gBAFb;AAGEF,MAAAA,MAAM,EAAE1D,KAAK,CAAC6D;AAHhB,KArBc,EA0Bd;AACE7B,MAAAA,KAAK,EAAE,KADT;AAEE4B,MAAAA,SAAS,EAAE;AAFb,KA1Bc,CAAhB;AA+BA,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAQ,MAAA,IAAI,EAAC,SAAb;AAAuB,MAAA,OAAO,EAAE,KAAKhD,UAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCADF,EAEE;AAAQ,MAAA,IAAI,EAAC,SAAb;AAAuB,MAAA,KAAK,EAAE;AAACkD,QAAAA,UAAU,EAAC,EAAZ;AAAeC,QAAAA,WAAW,EAAC;AAA3B,OAA9B;AAA8D,MAAA,OAAO,EAAE,KAAKnC,gBAA5E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAFF,EAGE;AAAQ,MAAA,IAAI,EAAC,SAAb;AAAuB,MAAA,OAAO,EAAE,KAAKa,cAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAHF,CADF,EAME;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,MAAD;AACE,MAAA,kBAAkB,EAAEzC,KAAK,CAACgE,kBAAN,CAAyBC,IAAzB,CAA8B,IAA9B,CADtB;AAEE,MAAA,eAAe,EAAE,KAAKxD,KAAL,CAAWyD,eAF9B;AAGE,MAAA,UAAU,EAAE,KAAKzD,KAAL,CAAW0D,IAHzB;AAIE,MAAA,OAAO,EAAER,OAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CANF,EAcE;AACE,MAAA,KAAK,EAAC,0BADR;AAEE,MAAA,OAAO,EAAE,KAAKlD,KAAL,CAAWC,aAFtB;AAGE,MAAA,IAAI,EAAE,KAAKI,gBAHb;AAIE,MAAA,QAAQ,EAAE,MAAM;AACd,aAAKE,QAAL,CAAcC,KAAd,CAAoBC,IAApB,CAAyBQ,WAAzB;AACA,aAAKb,QAAL,CAAc;AACZH,UAAAA,aAAa,EAAE;AADH,SAAd;AAGD,OATH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAWE,oBAAC,QAAD;AAAU,MAAA,mBAAmB,EAAG0D,IAAD,IAAU,KAAKpD,QAAL,GAAgBoD,IAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXF,CAdF,EA2BE;AACE,MAAA,KAAK,EAAC,0BADR;AAEE,MAAA,OAAO,EAAE,KAAK3D,KAAL,CAAWwB,aAFtB;AAGE,MAAA,KAAK,EAAE,GAHT;AAIE,MAAA,IAAI,EAAE,KAAKI,oBAJb;AAKE,MAAA,QAAQ,EAAE,MAAM;AACd,aAAKxB,QAAL,CAAc;AACZoB,UAAAA,aAAa,EAAE;AADH,SAAd;AAGD,OATH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAWE,oBAAC,YAAD;AACE,MAAA,mBAAmB,EAAGmC,IAAD,IAAU,KAAK9B,QAAL,GAAgB8B,IADjD;AAEE,MAAA,UAAU,EAAE,KAAK3D,KAAL,CAAWyB,UAFzB;AAGE,MAAA,QAAQ,EAAE,KAAKzB,KAAL,CAAW0B,QAHvB;AAIE,MAAA,aAAa,EAAGkC,WAAD,IAAiB;AAC9B,aAAKxD,QAAL,CAAc;AACZsB,UAAAA,QAAQ,EAAEkC;AADE,SAAd;AAGD,OARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXF,CA3BF,EAiDE;AACE,MAAA,KAAK,EAAC,0BADR;AAEE,MAAA,OAAO,EAAE,KAAK5D,KAAL,CAAWE,aAFtB;AAGE,MAAA,KAAK,EAAE,GAHT;AAIE,MAAA,IAAI,EAAE,KAAK4C,gBAJb;AAKE,MAAA,QAAQ,EAAE,MAAM;AACd,aAAK1C,QAAL,CAAc;AACZF,UAAAA,aAAa,EAAE;AADH,SAAd;AAGD,OATH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAWE,oBAAC,YAAD;AACE,MAAA,mBAAmB,EAAGyD,IAAD,IAAU,KAAKE,YAAL,GAAoBF,IADrD;AAEE,MAAA,UAAU,EAAE,KAAK3D,KAAL,CAAWyB,UAFzB;AAGE,MAAA,UAAU,EAAE,KAAKzB,KAAL,CAAWsC,UAHzB;AAIE,MAAA,QAAQ,EAAE,KAAKtC,KAAL,CAAWqC,QAJvB;AAKE,MAAA,aAAa,EAAGC,UAAD,IAAgB;AAC7B,aAAKlC,QAAL,CAAc;AACZkC,UAAAA;AADY,SAAd;AAGD,OATH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXF,CAjDF,CADF;AA2ED;;AAzPwD;;AA4P3D,MAAMwB,QAAN,SAAuBzE,KAAK,CAACU,SAA7B,CAAuC;AACrCkD,EAAAA,MAAM,GAAG;AACP,QAAIc,IAAI,GAAG,KAAKvD,KAAL,CAAWuD,IAAtB;AADO,UAECC,iBAFD,GAEuB,KAAKxD,KAAL,CAAWC,IAFlC,CAECuD,iBAFD;AAGP,UAAMC,cAAc,GAAG;AACrBC,MAAAA,QAAQ,EAAE;AAACC,QAAAA,IAAI,EAAC;AAAN,OADW;AAErBC,MAAAA,UAAU,EAAE;AAACD,QAAAA,IAAI,EAAE;AAAP;AAFS,KAAvB;AAKA,WACE;AAAM,MAAA,MAAM,EAAC,YAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAC;AAAhB,OAA2BF,cAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAEID,iBAAiB,CAAC,WAAD,CAAjB,CACE;AAAO,MAAA,IAAI,EAAC,MAAZ;AAAmB,MAAA,WAAW,EAAC,sCAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAFJ,CADF,EAQE,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAC;AAAhB,OAAyBC,cAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAEID,iBAAiB,CAAC,OAAD,CAAjB,CACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAEE,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF,CADF,CAFJ,CARF,CADF;AAqBD;;AA9BoC;;AAgCvCF,QAAQ,GAAG,MAAKO,MAAL,CAAY,EAAZ,EAAgBP,QAAhB,CAAX;;AACA,MAAMQ,YAAN,SAA2BjF,KAAK,CAACU,SAAjC,CAA0C;AAAA;AAAA;;AAAA,SAExCwE,OAFwC,GAE7BX,WAAD,IAAiB;AACzB,WAAKpD,KAAL,CAAWgE,aAAX,CAAyBZ,WAAzB;AACD,KAJuC;;AAAA,SAKxCa,eALwC,GAKrBnE,IAAD,IAAU;AAC1B,aAAOA,IAAI,CAACoE,GAAL,CAAUtD,IAAD,IAAU;AACxB,YAAGA,IAAI,CAACuD,QAAR,EAAkB;AAChB,iBAAO,oBAAC,QAAD;AAAU,YAAA,KAAK,EAAEvD,IAAI,CAACG,KAAtB;AAA6B,YAAA,GAAG,EAAEH,IAAI,CAACqB,GAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACJ,KAAKgC,eAAL,CAAqBrD,IAAI,CAACuD,QAA1B,CADI,CAAP;AAGD,SAJD,MAIO,OAAO,oBAAC,QAAD;AAAU,UAAA,KAAK,EAAEvD,IAAI,CAACG,KAAtB;AAA6B,UAAA,GAAG,EAAEH,IAAI,CAACqB,GAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACR,OANM,CAAP;AAOD,KAbuC;AAAA;;AAcxCQ,EAAAA,MAAM,GAAG;AAAA,UACCe,iBADD,GACuB,KAAKxD,KAAL,CAAWC,IADlC,CACCuD,iBADD;AAEP,UAAMC,cAAc,GAAG;AACrBC,MAAAA,QAAQ,EAAE;AAACC,QAAAA,IAAI,EAAC;AAAN,OADW;AAErBC,MAAAA,UAAU,EAAE;AAACD,QAAAA,IAAI,EAAE;AAAP;AAFS,KAAvB;AAIA,UAAMS,WAAW,GAAG,KAAKpE,KAAL,CAAWiB,UAA/B;AACA,UAAMC,QAAQ,GAAG,KAAKlB,KAAL,CAAWkB,QAA5B;AACA,WACE;AAAM,MAAA,MAAM,EAAC,YAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAC;AAAhB,OAA2BuC,cAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QACE;AAAO,MAAA,QAAQ,MAAf;AAAgB,MAAA,WAAW,EAAEW,WAAW,CAACC,SAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,EAIE,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAC;AAAhB,OAAyBZ,cAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAEID,iBAAiB,CAAC,QAAD,EAAU;AACzBc,MAAAA,YAAY,EAAE;AADW,KAAV,CAAjB,CAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAC,GAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAEE,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAC,GAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF,CAHF,CAFJ,CAJF,EAgBI;AACE,MAAA,SAAS,MADX;AAEE,MAAA,gBAAgB,MAFlB;AAGE,MAAA,OAAO,EAAGlB,WAAD,IAAiB;AACxB,aAAKW,OAAL,CAAaX,WAAb;AACD,OALH;AAME,MAAA,WAAW,EAAElC,QANf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAQE,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAC,0BAAhB;AAAuB,MAAA,GAAG,EAAC,cAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAK+C,eAAL,CAAqBhF,UAArB,CADH,CARF,CAhBJ,CADF;AA+BD;;AArDuC;;AAuD1C6E,YAAY,GAAG,MAAKD,MAAL,CAAY,EAAZ,EAAgBC,YAAhB,CAAf;;AAEA,MAAMS,YAAN,SAA2B1F,KAAK,CAACU,SAAjC,CAA0C;AAAA;AAAA;;AAAA,SAGxCiF,YAHwC,GAGzB,CAACC,UAAD,EAAaC,MAAb,KAAwBA,MAAM,CAAC3D,KAAP,CAAa4D,OAAb,CAAqBF,UAArB,IAAmC,CAAC,CAHnC;;AAAA,SAIxCG,YAJwC,GAIxB9C,UAAD,IAAgB;AAC7B,WAAK9B,KAAL,CAAW6E,aAAX,CAAyB/C,UAAzB;AACD,KANuC;AAAA;;AAOxCW,EAAAA,MAAM,GAAG;AAAA,UACCe,iBADD,GACuB,KAAKxD,KAAL,CAAWC,IADlC,CACCuD,iBADD;AAEP,UAAMC,cAAc,GAAG;AACrBC,MAAAA,QAAQ,EAAE;AAACC,QAAAA,IAAI,EAAC;AAAN,OADW;AAErBC,MAAAA,UAAU,EAAE;AAACD,QAAAA,IAAI,EAAE;AAAP;AAFS,KAAvB;AAIA,UAAMS,WAAW,GAAG,KAAKpE,KAAL,CAAWiB,UAA/B;AACA,UAAMC,QAAQ,GAAG,KAAKlB,KAAL,CAAWkB,QAA5B;AACA,WACE;AAAM,MAAA,MAAM,EAAC,YAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAC;AAAhB,OAA2BuC,cAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QACE;AAAO,MAAA,QAAQ,MAAf;AAAgB,MAAA,WAAW,EAAEW,WAAW,CAACC,SAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,EAIE,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAC;AAAhB,OAA2BZ,cAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QACE;AACE,MAAA,SAAS,EAAE;AAACqB,QAAAA,KAAK,EAAC,GAAP;AAAWC,QAAAA,MAAM,EAAC;AAAlB,OADb;AAEE,MAAA,UAAU,EAAE,KAAK/E,KAAL,CAAW6B,QAFzB;AAGE,MAAA,MAAM,EAAE,CAAC,MAAD,EAAQ,MAAR,CAHV;AAIE,MAAA,UAAU,MAJZ;AAKE,MAAA,iBAAiB,EAAC,gCALpB;AAME,MAAA,YAAY,EAAE,KAAK2C,YANrB;AAOE,MAAA,UAAU,EAAE,KAAKxE,KAAL,CAAW8B,UAPzB;AAQE,MAAA,QAAQ,EAAE,KAAK8C,YARjB;AASE,MAAA,MAAM,EAAEhE,IAAI,IAAIA,IAAI,CAACG,KATvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CAJF,CADF;AAoBD;;AAnCuC;;AAqC1CwD,YAAY,GAAG,MAAKV,MAAL,CAAY,EAAZ,EAAgBU,YAAhB,CAAf","sourcesContent":["import React from 'react'\r\nimport {Card, Button,Modal,Form,Select,Input,Tree, Transfer} from 'antd'\r\nimport ETable from './../../components/ETable'\r\nimport Utils from './../../utils/utils.js'\r\nimport axios from './../../axios/index.js'\r\nimport menuConfig from './../../config/menuConfig.js'\r\n\r\nconst Option = Select.Option\r\nconst FormItem = Form.Item\r\nconst { TreeNode } = Tree\r\nexport default class PermissionUser extends React.Component{\r\n  state = {\r\n    isRoleVisible: false,\r\n    isUserVisible: false\r\n  }\r\n  componentDidMount() {\r\n    axios.requestList(this,'/role/list',{})\r\n  }\r\n  // 打开创建角色弹框\r\n  handleRole = () => {\r\n    this.setState({\r\n      isRoleVisible: true\r\n    })\r\n  }\r\n  // 角色提交\r\n  handleRoleSubmit = () => {\r\n    let data = this.roleForm.props.form.getFieldsValue()\r\n    axios.ajax({\r\n      url: '/role/create',\r\n      data: {\r\n        params: data\r\n      }\r\n    }).then((res) => {\r\n      if(res.code == 0) {\r\n        this.setState({\r\n          isRoleVisible: false\r\n        })\r\n        this.roleForm.props.form.resetFields()\r\n        axios.requestList(this,'/role/list',{})\r\n      }\r\n    })\r\n  }\r\n  // 权限设置\r\n  handlePermission = () => {\r\n    let item = this.state.selectedItem\r\n    if(!item) {\r\n      Modal.info({\r\n        title: '请选择一个角色'\r\n      })\r\n      return \r\n    }\r\n    this.setState({\r\n      isPermVisible: true,\r\n      detailInfo: item,\r\n      menuInfo: item.menus\r\n    })\r\n  }\r\n  handlePermEditSubmit = () => {\r\n    let data = this.permForm.props.form.getFieldsValue()\r\n    data.role_id = this.state.selectedItem.id\r\n    data.menus = this.state.menuInfo\r\n    axios.ajax({\r\n      url: '/permission/edit',\r\n      data:  {\r\n        params: {\r\n          ...data\r\n        }\r\n      }\r\n    }).then((res) => {\r\n      if(res) {\r\n        this.setState({\r\n          isPermVisible: false\r\n        })\r\n        axios.requestList(this,'/role/list',{})\r\n      }\r\n    })\r\n  }\r\n  // 用户授权\r\n  handleUserAuth = () => {\r\n    let item = this.state.selectedItem\r\n    if(!item) {\r\n      Modal.info({\r\n        title: '请选择一个角色'\r\n      })\r\n      return \r\n    }\r\n    this.setState({\r\n      isUserVisible: true,\r\n      detailInfo: item\r\n    })\r\n    this.getRoleUserList(item.id)\r\n  }\r\n\r\n  getRoleUserList = (id) => {\r\n    axios.ajax({\r\n      url: '/role/user_list',\r\n      data: {\r\n        params: {\r\n          id\r\n        }\r\n      }\r\n    }).then((res) => {\r\n      if(res) {\r\n        \r\n        this.getAuthUserList(res.result)\r\n      }\r\n    })\r\n  }\r\n  // 筛选目标用户\r\n  getAuthUserList = (dataSource) => {\r\n    const mockData = []\r\n    const targetKeys = []\r\n    if(dataSource && dataSource.length > 0) {\r\n      for(let i = 0; i < dataSource.length; i++) {\r\n        const data = {\r\n          key: dataSource[i].user_id,\r\n          title: dataSource[i].user_name,\r\n          status: dataSource[i].status,\r\n        }\r\n        if(data.status == 1) {\r\n          targetKeys.push(data.key)\r\n        }\r\n        mockData.push(data)\r\n        \r\n      }\r\n      this.setState({\r\n        mockData,\r\n        targetKeys\r\n      })\r\n    }\r\n  }\r\n  // 用户授权提交\r\n  handleUserSubmit = () => {\r\n    let data = {}\r\n    data.user_ids = this.state.targetKeys\r\n    data.role_id = this.state.selectedItem.id\r\n    axios.ajax({\r\n      url: '/role/user_role_edit',\r\n      data: {\r\n        params: {\r\n          ...data\r\n        }\r\n      }\r\n    }).then((res) => {\r\n      if(res) {\r\n        this.setState({\r\n          isUserVisible: false\r\n        })\r\n        axios.requestList(this,'/role/list',{})\r\n      }\r\n    })\r\n  }\r\n  render() {\r\n    const columns = [\r\n      {\r\n        title: '角色ID',\r\n        dataIndex: 'id'\r\n      },\r\n      {\r\n        title: '角色名称',\r\n        dataIndex: 'role_name'\r\n      },\r\n      {\r\n        title: '创建时间',\r\n        dataIndex: 'create_time',\r\n        render: Utils.formateDate\r\n      },\r\n      {\r\n        title: '使用状态',\r\n        dataIndex: 'status',\r\n        render(status){\r\n          return status == 1 ? '启用' : '停用'\r\n        }\r\n      },\r\n      {\r\n        title: '授权时间',\r\n        dataIndex: 'authorize_time',\r\n        render: Utils.formateDate\r\n      },\r\n      {\r\n        title: '授权人',\r\n        dataIndex: 'authorize_user_name'\r\n      },\r\n    ]\r\n    return(\r\n      <div>\r\n        <Card>\r\n          <Button type=\"primary\" onClick={this.handleRole}>创建角色</Button>\r\n          <Button type=\"primary\" style={{marginLeft:15,marginRight:15}} onClick={this.handlePermission}>设置权限</Button>\r\n          <Button type=\"primary\" onClick={this.handleUserAuth}>用户授权</Button>\r\n        </Card>\r\n        <div className=\"content-wrap\">\r\n          <ETable \r\n            updateSelectedItem={Utils.updateSelectedItem.bind(this)}\r\n            selectedRowKeys={this.state.selectedRowKeys}\r\n            dataSource={this.state.list}\r\n            columns={columns}\r\n          />\r\n        </div>\r\n        <Modal \r\n          title=\"创建角色\"\r\n          visible={this.state.isRoleVisible}\r\n          onOk={this.handleRoleSubmit}\r\n          onCancel={() => {\r\n            this.roleForm.props.form.resetFields()\r\n            this.setState({\r\n              isRoleVisible: false\r\n            })\r\n          }}\r\n        >\r\n          <RoleForm wrappedComponentRef={(inst) => this.roleForm = inst}></RoleForm>\r\n        </Modal>\r\n        <Modal\r\n          title=\"设置权限\"\r\n          visible={this.state.isPermVisible}\r\n          width={600}\r\n          onOk={this.handlePermEditSubmit}\r\n          onCancel={() => {\r\n            this.setState({\r\n              isPermVisible: false\r\n            })\r\n          }}\r\n        >\r\n          <PermEditForm\r\n            wrappedComponentRef={(inst) => this.permForm = inst}\r\n            detailInfo={this.state.detailInfo}\r\n            menuInfo={this.state.menuInfo}\r\n            patchMenuInfo={(checkedKeys) => {\r\n              this.setState({\r\n                menuInfo: checkedKeys\r\n              })\r\n            }}\r\n          /> \r\n        </Modal>\r\n        <Modal\r\n          title=\"用户授权\"\r\n          visible={this.state.isUserVisible}\r\n          width={800}\r\n          onOk={this.handleUserSubmit}\r\n          onCancel={() => {\r\n            this.setState({\r\n              isUserVisible: false\r\n            })\r\n          }}\r\n        >\r\n          <RoleAuthForm\r\n            wrappedComponentRef={(inst) => this.userAuthForm = inst}\r\n            detailInfo={this.state.detailInfo}\r\n            targetKeys={this.state.targetKeys}\r\n            mockData={this.state.mockData}\r\n            patchUserInfo={(targetKeys) => {\r\n              this.setState({\r\n                targetKeys\r\n              })\r\n            }}\r\n          /> \r\n        </Modal>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nclass RoleForm extends React.Component {\r\n  render() {\r\n    let type = this.props.type\r\n    const { getFieldDecorator } = this.props.form\r\n    const formTtemLayout = {\r\n      labelCol: {span:5},\r\n      wrapperCol: {span: 15}\r\n    }\r\n    \r\n    return(\r\n      <Form layout=\"horizontal\">\r\n        <FormItem label=\"角色名称\" {...formTtemLayout}>\r\n          {\r\n            getFieldDecorator('role_name')(\r\n              <Input type=\"text\" placeholder=\"请输入角色名\"/>\r\n            )\r\n          }\r\n        </FormItem>\r\n        <FormItem label=\"状态\" {...formTtemLayout}>\r\n          {\r\n            getFieldDecorator('state')(\r\n              <Select>\r\n                <Option value={1}>开启</Option>\r\n                <Option value={2}>关闭</Option>\r\n              </Select>\r\n            )\r\n          }\r\n        </FormItem>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\nRoleForm = Form.create({})(RoleForm)\r\nclass PermEditForm extends React.Component{\r\n\r\n  onCheck = (checkedKeys) => {\r\n    this.props.patchMenuInfo(checkedKeys)\r\n  }\r\n  renderTreeNodes = (data) => {\r\n    return data.map((item) => {\r\n      if(item.children) {\r\n        return <TreeNode title={item.title} key={item.key}>\r\n          {this.renderTreeNodes(item.children)}\r\n        </TreeNode>\r\n      } else return <TreeNode title={item.title} key={item.key}/>\r\n    })\r\n  }\r\n  render() {\r\n    const { getFieldDecorator } = this.props.form\r\n    const formTtemLayout = {\r\n      labelCol: {span:5},\r\n      wrapperCol: {span: 15}\r\n    }\r\n    const detail_info = this.props.detailInfo\r\n    const menuInfo = this.props.menuInfo\r\n    return(\r\n      <Form layout=\"horizontal\">\r\n        <FormItem label=\"角色名称\" {...formTtemLayout}>\r\n          <Input disabled placeholder={detail_info.role_name}/>\r\n        </FormItem>\r\n        <FormItem label=\"状态\" {...formTtemLayout}>\r\n          {\r\n            getFieldDecorator('status',{\r\n              initialValue: '1'\r\n            })(\r\n              <Select>\r\n                <Option value=\"1\">启用</Option>\r\n                <Option value=\"0\">停用</Option>\r\n              </Select>\r\n            )\r\n          }\r\n        </FormItem>\r\n          <Tree \r\n            checkable\r\n            defaultExpandAll\r\n            onCheck={(checkedKeys) => {\r\n              this.onCheck(checkedKeys)\r\n            }}\r\n            checkedKeys={menuInfo}\r\n          >\r\n            <TreeNode title=\"平台权限\" key=\"platform_all\">\r\n              {this.renderTreeNodes(menuConfig)}\r\n            </TreeNode>\r\n          </Tree>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\nPermEditForm = Form.create({})(PermEditForm)\r\n\r\nclass RoleAuthForm extends React.Component{\r\n\r\n  \r\n  filterOption = (inputValue, option) => option.title.indexOf(inputValue) > -1;\r\n  handleChange = (targetKeys) => {\r\n    this.props.patchUserInfo(targetKeys)\r\n  }\r\n  render() {\r\n    const { getFieldDecorator } = this.props.form\r\n    const formTtemLayout = {\r\n      labelCol: {span:5},\r\n      wrapperCol: {span: 15}\r\n    }\r\n    const detail_info = this.props.detailInfo\r\n    const menuInfo = this.props.menuInfo\r\n    return(\r\n      <Form layout=\"horizontal\">\r\n        <FormItem label=\"角色名称\" {...formTtemLayout}>\r\n          <Input disabled placeholder={detail_info.role_name}/>\r\n        </FormItem>\r\n        <FormItem label=\"选择用户\" {...formTtemLayout}>\r\n          <Transfer \r\n            listStyle={{width:200,height:400}}\r\n            dataSource={this.props.mockData}\r\n            titles={['待选用户','已选用户']}\r\n            showSearch\r\n            searchPlaceholder=\"输入用户名\"\r\n            filterOption={this.filterOption}\r\n            targetKeys={this.props.targetKeys}\r\n            onChange={this.handleChange}\r\n            render={item => item.title}\r\n          />\r\n        </FormItem>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\nRoleAuthForm = Form.create({})(RoleAuthForm)"]},"metadata":{},"sourceType":"module"}