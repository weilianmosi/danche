{"ast":null,"code":"import \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nvar _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\\\u5355\\u8F66\\u540E\\u53F0\\u7BA1\\u7406\\u7CFB\\u7EDF\\u5F00\\u53D1\\\\imoocmanager\\\\src\\\\pages\\\\map\\\\bikeMap.js\";\nimport React from 'react';\nimport axios from './../../axios/index.js';\nimport BaseForm from '../../components/BaseForm/index.js';\nexport default class BikeMap extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {};\n    this.map = '';\n    this.formList = [{\n      type: '城市'\n    }, {\n      type: '时间查询'\n    }, {\n      type: 'SELECT',\n      label: '订单状态',\n      field: 'order_status',\n      placeholder: '全部',\n      initialValue: '0',\n      list: [{\n        id: '0',\n        name: '全部'\n      }, {\n        id: '1',\n        name: '进行中'\n      }, {\n        id: '2',\n        name: '行程结束'\n      }]\n    }];\n\n    this.requestList = () => {\n      axios.ajax({\n        url: '/map/bike_list',\n        data: {\n          params: this.params\n        }\n      }).then(res => {\n        if (res.code == 0) {\n          this.setState({\n            total_count: res.result.total_count\n          });\n          this.renderMap(res);\n        }\n      });\n    };\n\n    this.handleFilterSubmit = filterParams => {\n      this.params = filterParams;\n      this.requestList();\n    };\n\n    this.renderMap = res => {\n      let list = res.result.route_list;\n      this.map = new window.BMap.Map('container');\n      let gps1 = list[0].split(',');\n      let startPoint = new window.BMap.Point(gps1[0], gps1[1]);\n      let gps2 = list[list.length - 1].split(',');\n      let endPoint = new window.BMap.Point(gps2[0], gps2[1]);\n      this.map.centerAndZoom(endPoint, 11);\n      let startPointIcon = new window.BMap.Icon('/assets/start_point.png', new window.BMap.Size(36, 42), {\n        imageSize: new window.BMap.Size(36, 42),\n        anchor: new window.BMap.Size(18, 42)\n      });\n      let bikeMarkerStart = new window.BMap.Marker(startPoint, {\n        icon: startPointIcon\n      });\n      this.map.addOverlay(bikeMarkerStart);\n      let endPointIcon = new window.BMap.Icon('/assets/end_point.png', new window.BMap.Size(36, 42), {\n        imageSize: new window.BMap.Size(36, 42),\n        anchor: new window.BMap.Size(18, 42)\n      });\n      let bikeMarkerEnd = new window.BMap.Marker(endPoint, {\n        icon: endPointIcon\n      });\n      this.map.addOverlay(bikeMarkerEnd); // 绘制车辆行驶路线\n\n      let routeList = [];\n      list.forEach(item => {\n        let p = item.split(',');\n        routeList.push(new window.BMap.Point(p[0], p[1]));\n      });\n      let polyLine = new window.BMap.Polyline(routeList, {\n        strokeColor: '#ef4136',\n        strokeWeight: 2,\n        strokeOpacity: 1\n      });\n      this.map.addOverlay(polyLine); // 绘制服务器\n\n      let servicePointList = [];\n      let serviceList = res.result.service_list;\n      serviceList.forEach(item => {\n        servicePointList.push(new window.BMap.Point(item.lon, item.lat));\n      });\n      let polyServiceLine = new window.BMap.Polyline(servicePointList, {\n        strokeColor: '#ef4136',\n        strokeWeight: 3,\n        strokeOpacity: 1\n      });\n      this.map.addOverlay(polyServiceLine); // 添加地图中的自行车图标\n\n      let bikeList = res.result.bike_list;\n      let bikeIcon = new window.BMap.Icon('/assets/bike.jpg', new window.BMap.Size(36, 42), {\n        imageSize: new window.BMap.Size(36, 42),\n        anchor: new window.BMap.Size(18, 42)\n      });\n      bikeList.forEach(item => {\n        let p = item.split(',');\n        let point = new window.BMap.Point(p[0], p[1]);\n        let bikeMarker = new window.BMap.Marker(point, {\n          icon: bikeIcon\n        });\n        this.map.addOverlay(bikeMarker);\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.requestList();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(_Card, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(BaseForm, {\n      formList: this.formList,\n      filterSubmit: this.handleFilterSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    })), React.createElement(_Card, {\n      style: {\n        marginTop: 10\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, \"\\u5171\", this.state.total_count, \"\\u8F86\\u8F66\"), React.createElement(\"div\", {\n      id: \"container\",\n      style: {\n        height: 500\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    })));\n  }\n\n}","map":{"version":3,"sources":["C:\\Users\\Administrator\\Desktop\\单车后台管理系统开发\\imoocmanager\\src\\pages\\map\\bikeMap.js"],"names":["React","axios","BaseForm","BikeMap","Component","state","map","formList","type","label","field","placeholder","initialValue","list","id","name","requestList","ajax","url","data","params","then","res","code","setState","total_count","result","renderMap","handleFilterSubmit","filterParams","route_list","window","BMap","Map","gps1","split","startPoint","Point","gps2","length","endPoint","centerAndZoom","startPointIcon","Icon","Size","imageSize","anchor","bikeMarkerStart","Marker","icon","addOverlay","endPointIcon","bikeMarkerEnd","routeList","forEach","item","p","push","polyLine","Polyline","strokeColor","strokeWeight","strokeOpacity","servicePointList","serviceList","service_list","lon","lat","polyServiceLine","bikeList","bike_list","bikeIcon","point","bikeMarker","componentDidMount","render","marginTop","height"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport axios from './../../axios/index.js'\r\nimport BaseForm from '../../components/BaseForm/index.js'\r\nimport {Card, Form} from 'antd'\r\n\r\nexport default class BikeMap extends React.Component {\r\n  componentDidMount() {\r\n    this.requestList()\r\n  }\r\n  state = {}\r\n  map = ''\r\n  formList = [\r\n    {\r\n      type: '城市',\r\n    },\r\n    {\r\n      type: '时间查询',\r\n    },\r\n    {\r\n      type: 'SELECT',\r\n      label: '订单状态',\r\n      field: 'order_status',\r\n      placeholder: '全部',\r\n      initialValue: '0',\r\n      list: [{id:'0',name:'全部'},{id:'1',name:'进行中'},{id:'2',name:'行程结束'}]\r\n    }\r\n  ]\r\n  requestList = () => {\r\n    axios.ajax({\r\n      url: '/map/bike_list',\r\n      data: {\r\n        params: this.params\r\n      }\r\n    }).then((res) => {\r\n      if(res.code == 0) {\r\n        this.setState({\r\n          total_count: res.result.total_count,\r\n        })\r\n        this.renderMap(res)\r\n      }\r\n    })\r\n  }\r\n  // 查询表单\r\n  handleFilterSubmit = (filterParams) => {\r\n    this.params = filterParams\r\n    this.requestList()\r\n  }\r\n  // 渲染地图数据\r\n  renderMap = (res) => {\r\n    let list = res.result.route_list\r\n    this.map = new window.BMap.Map('container')\r\n    let gps1 = list[0].split(',')\r\n    let startPoint = new window.BMap.Point(gps1[0],gps1[1])\r\n    let gps2 = list[list.length-1].split(',')\r\n    let endPoint = new window.BMap.Point(gps2[0],gps2[1])\r\n    this.map.centerAndZoom(endPoint,11)\r\n\r\n    let startPointIcon = new window.BMap.Icon('/assets/start_point.png',new window.BMap.Size(36,42),{\r\n      imageSize: new window.BMap.Size(36,42),\r\n      anchor: new window.BMap.Size(18,42)\r\n    })\r\n    let bikeMarkerStart = new window.BMap.Marker(startPoint,{icon:startPointIcon})\r\n    this.map.addOverlay(bikeMarkerStart)\r\n    let endPointIcon = new window.BMap.Icon('/assets/end_point.png',new window.BMap.Size(36,42),{\r\n      imageSize: new window.BMap.Size(36,42),\r\n      anchor: new window.BMap.Size(18,42)\r\n    })\r\n    let bikeMarkerEnd = new window.BMap.Marker(endPoint,{icon:endPointIcon})\r\n    this.map.addOverlay(bikeMarkerEnd)\r\n\r\n    // 绘制车辆行驶路线\r\n    let routeList = []\r\n    list.forEach((item) => {\r\n      let p = item.split(',')\r\n      routeList.push(new window.BMap.Point(p[0],p[1]))\r\n    })\r\n    let polyLine = new window.BMap.Polyline(routeList,{\r\n      strokeColor: '#ef4136',\r\n      strokeWeight: 2,\r\n      strokeOpacity: 1\r\n    })\r\n    this.map.addOverlay(polyLine)\r\n\r\n    // 绘制服务器\r\n    let servicePointList = []\r\n    let serviceList = res.result.service_list\r\n    serviceList.forEach((item) => {\r\n      servicePointList.push(new window.BMap.Point(item.lon,item.lat))\r\n    })\r\n    let polyServiceLine = new window.BMap.Polyline(servicePointList,{\r\n      strokeColor: '#ef4136',\r\n      strokeWeight: 3,\r\n      strokeOpacity: 1\r\n    })\r\n    this.map.addOverlay(polyServiceLine)\r\n\r\n    // 添加地图中的自行车图标\r\n    let bikeList = res.result.bike_list\r\n    let bikeIcon = new window.BMap.Icon('/assets/bike.jpg',new window.BMap.Size(36,42),{\r\n      imageSize: new window.BMap.Size(36,42),\r\n      anchor: new window.BMap.Size(18,42)\r\n    })\r\n    bikeList.forEach((item) => {\r\n      let p = item.split(',')\r\n      let point = new window.BMap.Point(p[0],p[1])\r\n      let bikeMarker = new window.BMap.Marker(point,{icon: bikeIcon})\r\n      this.map.addOverlay(bikeMarker)\r\n    })\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Card>\r\n          <BaseForm formList={this.formList} filterSubmit={this.handleFilterSubmit} />\r\n        </Card>\r\n        <Card style={{marginTop: 10}}>\r\n          <div>共{this.state.total_count}辆车</div>\r\n          <div id=\"container\" style={{height:500}}></div>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}